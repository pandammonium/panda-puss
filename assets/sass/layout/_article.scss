@use 'sass:string';
@use 'metadata';

@mixin article($content-type) {

  @if $content-type != "content" and $content-type != 'excerpt' {
    @error "Unknown post content type";
  }
  margin: auto;
  $grid-areas: "";

  // @debug "content type: #{$content-type}";

  & {
    // background-color: yellow;
    // border: 1px solid yellow;
    margin: 0;
    padding: 0;
    // Grid container
    display: grid;
    grid-template-columns: clamp(10vw, 200px, 20vw) minmax(10px, 1fr);
    grid-template-rows: auto;
    column-gap: calc(2 * var(--pp--space--hor));
    row-gap: calc(1 * var(--pp--space--ver));
    place-content: stretch;
    place-items: stretch;
    // End of grid container
    // @debug "#{&}";
    &-header {
      // Grid item
      grid-area: article-header;
      // End of grid item
      // Grid container
      display: grid;
      grid-template-columns: 100%;
      grid-template-rows: auto;
      grid-template-areas:
        "post-title"
      ;
      // End of grid container
      margin: 0;
    }
    &-body {
      // background-color: cornsilk;
      // Grid item
      grid-area: article-body;
      // End of grid item
      // Grid container
      display: grid;
      grid-template-columns: 100%;
      grid-template-rows: auto;
      grid-template-areas:
        "post-#{$content-type}"
      ;
      // End of grid container
      margin: 0;
    }
    &-footer {
      // Grid item
      grid-area: article-footer;
      // End of grid item
      // Grid container
      display: grid;
      grid-template-columns: 100%;
      grid-template-rows: auto;
      grid-template-areas:
        "metadata"
      ;
      // End of grid container
      margin: 0;
      @include metadata.metadata('article');
    }
    &-featured_image {
      // background-color: gold;
      // border: 1px solid gold;
      margin: inherit;
      padding: inherit;
      // Grid item
      grid-area: article-featured_image;
      // End of grid item
    }

    &-title {
      // background-color: green;
      // border: 1px solid green;
      // Grid item
      grid-area: post-title;
      // End of grid item
      margin: 0;
    }

    &-body {
      // background-color: darkcyan;
      // border: 1px solid darkcyan;
      margin: inherit;
      padding: inherit;
      &_excerpt {
        // background-color: lightcyan;
        // border: 1px solid lightcyan;
        // Grid item
        grid-area: post-excerpt;
        // End of grid item
      }
      &_full {
        // background-color: cyan;
        // border: 1px solid cyan;
        // Grid item
        grid-area: post-content;
        // End of grid item
      }
      img {
        // Make sure images don't stick off the edge of the page:
        height: auto;
        max-width: 100%;
      }
    }
    @if ($content-type == "content") {
      &.pp-focus {
        .pp-article-featured_image {
          margin: auto;
        }
      }
    }
  }

  @if ($content-type == "content") {
    &.pp-focus {
      // @debug "#{&}";
      $image: "\"article-featured_image\"";
      $header: "\"article-header\"";
      $footer: "\"article-footer\"";
      $body: "\"article-body\"";
      $grid-areas: #{$header} + " " + #{$image} + " " + #{$body} + " "  + #{$footer};
      // @debug "grid (focus): #{$grid-areas}";
      // background-color: maroon;
      // border: 1px solid maroon;
      // Grid container
      grid-template-columns: 100%;
      grid-template-areas:
        #{$grid-areas}
      ;
      column-gap: calc(0 * var(--pp--space--hor));
      row-gap: calc(1 * var(--pp--space--ver));
      // End of grid container
    }
  } @else if ($content-type == "excerpt") {
    &.pp-front_page {
      // background-color: darkorchid;
      // border: 1px solid darkorchid;
      // @debug "#{&}";
      grid-template-columns: 100%;
      $image: "\"article-featured_image\"";
      $header: "\"article-header\"";
      $body: "\"article-body\"";
      $footer: "\"article-footer\"";
      $grid-areas: #{$header} + " " + #{$image} + " " + #{$body} + " "  + #{$footer};
      // @debug "grid (front page): #{$grid-areas}";

      // @debug "grid (focus): #{$grid-areas}";
      // background-color: maroon;
      // border: 1px solid maroon;
      // Grid container
      // grid-template-columns: 100%;
      grid-template-areas:
        #{$grid-areas}
      ;
      column-gap: calc(0 * var(--pp--space--hor));
      row-gap: calc(1 * var(--pp--space--ver));
      // End of grid container
    }
  }
  &.pp-no-featured_image {
    // @debug "#{&}";
    grid-template-columns: 100%;
    $header: "\"article-header\"";
    $footer: "\"article-footer\"";
    $body: "\"article-body\"";
    $grid-areas: #{$header} + " " + #{$body} + " "  + #{$footer};
    // @debug "grid (no feat. img.): #{$grid-areas}";
    // background-color: mediumaquamarine;
    // border: 1px solid mediumaquamarine;
    // Grid container
    grid-template-areas:
      #{$grid-areas}
    ;
    // End of grid container
    .pp-article-featured_image {
      display: none;
    }
  }
  @media (min-width: 601px) {
    & {
      // @debug "larger screen";
      // @debug "#{&}";
      $header: "\"article-featured_image article-header\"";
      $body: "\"article-featured_image article-body\"";
      $footer: "\"article-featured_image article-footer\"";
      $grid-areas: #{$header} + " " + #{$body} + " "  + #{$footer};
      // @debug "grid (larger-screen): #{$grid-areas}";
      grid-template-areas:
        #{$grid-areas}
      ;
    }
  }
  @media (max-width: 600px) {
    & {
      // @debug "smaller screen";
      // @debug "#{&}";
      grid-template-columns: auto;
      grid-template-rows: auto;
      $image: "\"article-featured_image\"";
      $header: "\"article-header\"";
      $footer: "\"article-footer\"";
      $body: "\"article-body\"";
      $grid-areas: #{$image} + " " + #{$header} + " " + #{$body} + " "  + #{$footer};
      ;
      grid-template-areas:
        #{$grid-areas}
      ;
    }
  }
} // End of @mixin post-content
